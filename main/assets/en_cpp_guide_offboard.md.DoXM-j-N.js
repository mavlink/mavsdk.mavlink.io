import{_ as i,c as a,al as e,o as t}from"./chunks/framework.BVh3rIuO.js";const c=JSON.parse('{"title":"Offboard Control","description":"","frontmatter":{"github_branch":"main"},"headers":[],"relativePath":"en/cpp/guide/offboard.md","filePath":"en/cpp/guide/offboard.md"}'),n={name:"en/cpp/guide/offboard.md"};function h(l,s,p,o,r,d){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="offboard-control" tabindex="-1">Offboard Control <a class="header-anchor" href="#offboard-control" aria-label="Permalink to &quot;Offboard Control&quot;">​</a></h1><p>The <a href="./../api_reference/classmavsdk_1_1_offboard.html">Offboard</a> MAVSDK plugin provides a simple API for controlling the vehicle using velocity and yaw setpoints. It is useful for tasks requiring direct control from a companion computer; for example to implement collision avoidance.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The API uses the PX4 <a href="https://docs.px4.io/master/en/flight_modes/offboard.html" target="_blank" rel="noreferrer">Offboard flight mode</a>. The class can only be used with copter and VTOL vehicles (not fixed wing - a PX4 limitation) and currently only supports <em>velocity setpoint commands</em> (PX4 additionally supports position and thrust setpoints).</p></div><p>Client code must specify a setpoint before starting <em>Offboard mode</em>. The Offboard plugin automatically resends setpoints at 20Hz (PX4 requires that setpoints are minimally resent at 2Hz). If more precise control is required, clients can call the setpoint methods at whatever rate is required or whenever an updated setpoint is available.</p><h2 id="create-the-plugin" tabindex="-1">Create the Plugin <a class="header-anchor" href="#create-the-plugin" aria-label="Permalink to &quot;Create the Plugin&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>Offboard</code> objects are created in the same way as other SDK plugins. General instructions are provided in the topic: <a href="./../guide/using_plugins.html">Using Plugins</a>.</p></div><p>The main steps are:</p><ol><li><a href="./../guide/connections.html">Create a connection</a> to a <code>system</code>. For example (basic code without error checking):<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;mavsdk/mavsdk.h&gt;</span></span>
<span class="line"><span>Mavsdk mavsdk{Mavsdk::Configuration{Mavsdk::ComponentType::GroundStation}};</span></span>
<span class="line"><span>ConnectionResult conn_result = mavsdk.add_udp_connection();</span></span>
<span class="line"><span>// Wait for the system to connect via heartbeat</span></span>
<span class="line"><span>while (mavsdk.system().size() == 0) {</span></span>
<span class="line"><span>   sleep_for(seconds(1));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>// System got discovered.</span></span>
<span class="line"><span>System system = mavsdk.systems()[0];</span></span></code></pre></div></li><li>Create a shared pointer to an instance of <code>Offboard</code> instantiated with the <code>system</code>:<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;mavsdk/plugins/offboard/offboard.h&gt;</span></span>
<span class="line"><span>auto offboard = Offboard{system};</span></span></code></pre></div></li></ol><p>The <code>offboard</code> pointer can then used to access the plugin API (as shown in the following sections).</p><h2 id="starting-stopping-offboard-mode" tabindex="-1">Starting/Stopping Offboard Mode <a class="header-anchor" href="#starting-stopping-offboard-mode" aria-label="Permalink to &quot;Starting/Stopping Offboard Mode&quot;">​</a></h2><p>To use offboard mode you must first create a setpoint using any of the setpoint setter methods (e.g. <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1a4edbc6e4528ff955d4e46e7c4e711732">set_velocity_ned()</a> or <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1abe7364f0a48dda4df34c5c67d177cfb4">set_velocity_body()</a>). You can use any setpoint you like - the vehicle will start acting on the current setpoint as soon as the mode starts.</p><p>After you have created a setpoint call <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1ab71d0dd2a81f76e3a0330b0304daa30b">start()</a> or <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1a0c880ad3f663142e194dd6f187cfc934">start_async()</a> to switch to offboard mode.</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create a setpoint before starting offboard mode (in this case a null setpoint)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Start offboard mode.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Offboard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::Result offboard_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Offboard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::Success) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::cerr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Offboard::start() failed: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offboard_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>The methods return/complete with a <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1a2d4d594301d8c756429457b0982130e9">Result</a> indicating whether the command was successful. Above we use the synchronous API, and then print a human readable string for the returned enum.</p><p>You can change the setpoints as needed (new setpoints replace any old setpoints).</p><p>To stop offboard mode call <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1a626810cbfa02b36019dde2d2fd4c3da9">Offboard::stop()</a> or <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1a86c163d7fa1217b4e82a03daf52065c3">stop_async()</a>. The SDK will then clear the current setpoint and put the vehicle into <a href="https://docs.px4.io/master/en/flight_modes/hold.html" target="_blank" rel="noreferrer">Hold flight mode</a>. The synchronous API is used as shown below:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//Stop offboard mode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Offboard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::Success) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::cerr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Offboard::stop() failed: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offboard_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Offboard mode can also be stopped by moving the vehicle into another mode (e.g. using the <code>Action</code> API).</p></div><h2 id="velocity-setpoints" tabindex="-1">Velocity Setpoints <a class="header-anchor" href="#velocity-setpoints" aria-label="Permalink to &quot;Velocity Setpoints&quot;">​</a></h2><p>The API provides methods to set velocity and yaw components using the NED frame (<code>set_velocity_ned()</code>) and the body frame (<code>set_velocity_body()</code>). The difference is that NED is relative to an absolute coordinate system (North, East, Down) while body frame is relative to the vehicle orientation (front, right, down).</p><p>The NED frame is used to move towards a specific compass direction or face the vehicle in a specific compass direction. Body frame is usually used for tasks where the vehicle needs to <em>deviate</em> from the current path (e.g. to avoid an obstacle) or to rotate the vehicle at a specific rate. Movement up/down is the same in either frame.</p><p>The following sections provide some common usage examples.</p><h3 id="move-in-compass-direction" tabindex="-1">Move in Compass Direction <a class="header-anchor" href="#move-in-compass-direction" aria-label="Permalink to &quot;Move in Compass Direction&quot;">​</a></h3><p>The <code>set_velocity_ned()</code> can be used to move towards any particular compass direction - e.g. North, West, South-East, etc.</p><p>Calling <code>set_velocity_ned()</code> using an initialiser list type declaration for the <a href="./../api_reference/structmavsdk_1_1_offboard_1_1_velocity_ned_yaw.html">VelocityNEDYaw</a> argument, the first three values are the velocity components in North, East, and Down directions (in metres/second).</p><p>Examples:</p><ul><li>Head North at 3 m/s:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_ned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li>Head North-West with 5 m/s on each velocity component (notice that a negative value is required on the <code>east_m_s</code> value to move West):<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_ned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="go-up-or-down" tabindex="-1">Go Up or Down <a class="header-anchor" href="#go-up-or-down" aria-label="Permalink to &quot;Go Up or Down&quot;">​</a></h3><p>Both coordinate systems use the same definition for &quot;down&quot;, and both methods take an argument where the third value is used to specify the velocity component in this direction. The following examples show how you set the velocity component down (positive) or up (negative) using the two methods:</p><p>Examples:</p><ul><li>Go <em>up</em> at 2 m/s (note, negative value to go up!):<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_ned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li>Go down at 3 m/s:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="turn-yaw-vehicle-to-face-a-compass-direction" tabindex="-1">Turn/Yaw Vehicle to Face a Compass Direction <a class="header-anchor" href="#turn-yaw-vehicle-to-face-a-compass-direction" aria-label="Permalink to &quot;Turn/Yaw Vehicle to Face a Compass Direction&quot;">​</a></h3><p>The <code>set_velocity_ned()</code> can be used to face the vehicle in a particular direction, independent of the direction of travel. The direction is specified in clockwise degrees relative to North (0 is North, 90 is East, 180 is South, etc.)</p><p>Calling <code>set_velocity_ned()</code> using an initialiser list type declaration for the <code>VelocityNEDYaw</code> argument, the final (fourth) value is the yaw direction.</p><p>Examples:</p><ul><li>Turn to face West:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_ned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">270.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li>Turn to face North:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_ned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><p>It is not possible to control the rate or direction that the vehicle will use to turn towards the setpoint direction (it will turn in whatever direction reaches the setpoint fastest).</p><h3 id="turn-yaw-vehicle-in-specified-direction-at-rate" tabindex="-1">Turn/Yaw Vehicle in specified Direction/at Rate <a class="header-anchor" href="#turn-yaw-vehicle-in-specified-direction-at-rate" aria-label="Permalink to &quot;Turn/Yaw Vehicle in specified Direction/at Rate&quot;">​</a></h3><p>The <code>set_velocity_body()</code> can be used to rotate the vehicle at a specific rate and in a specified direction. This is set in <a href="./../api_reference/structmavsdk_1_1_offboard_1_1_velocity_body_yawspeed.html#structmavsdk_1_1_offboard_1_1_velocity_body_yawspeed_1a102d7011d9a87c6e103f1c1b92d169ee">VelocityBodyYawspeed::yawspeed_deg_s</a>, as the angular rate in degrees/second. If viewed from above, the vehicle will turn clockwise if the value is positive and anticlockwise if it is negative.</p><p>Calling <code>set_velocity_body()</code> using an initialiser list type declaration the final (fourth) value is the yaw rate/direction.</p><p>Examples:</p><ul><li>Turn clock-wise at 60 degrees per second:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li>Turn anti clock-wise at 5 degrees per second:<div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="fly-forwards" tabindex="-1">Fly Forwards <a class="header-anchor" href="#fly-forwards" aria-label="Permalink to &quot;Fly Forwards&quot;">​</a></h3><p>Use <code>set_velocity_body()</code> to set the velocity components relative to the body frame. To fly forwards, simply set the first parameter (<code>Offboard::VelocityBodyYawspeed::forward_m_s</code>) when the vehicle is not rotating.</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="fly-a-circle" tabindex="-1">Fly a Circle <a class="header-anchor" href="#fly-a-circle" aria-label="Permalink to &quot;Fly a Circle&quot;">​</a></h3><p>To fly a circle, use <code>set_velocity_body()</code> with both forward and rotational components. This will force the vehicle to travel in a curved path.</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>You can force the vehicle to fly sideways by using the (<code>Offboard::VelocityBodyYawspeed::right_m_s</code> value), and in the other direction by using a negative rotation value:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Fly a circle sideways</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offboard.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_velocity_body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="position-thrust-setpoints" tabindex="-1">Position/Thrust Setpoints <a class="header-anchor" href="#position-thrust-setpoints" aria-label="Permalink to &quot;Position/Thrust Setpoints&quot;">​</a></h2><p>The SDK does not support position or thrust setpoints (at time of writing).</p><h2 id="waiting-on-setpoints" tabindex="-1">Waiting on Setpoints <a class="header-anchor" href="#waiting-on-setpoints" aria-label="Permalink to &quot;Waiting on Setpoints&quot;">​</a></h2><p>The vehicle will obey the last setpoint called (when you call a setpoint the last one is cleared). The SDK examples use timers to separate commands (e.g. <code>sleep_for(seconds(8))</code>) but in a real-world use case you might use telemetry or sensors to control when the setpoint is changed.</p><h2 id="monitoring-offboard-mode" tabindex="-1">Monitoring Offboard Mode <a class="header-anchor" href="#monitoring-offboard-mode" aria-label="Permalink to &quot;Monitoring Offboard Mode&quot;">​</a></h2><p>The vehicle may change out of offboard mode outside the control of your application (for example if a GCS were to put the vehicle into <em>Hold mode</em>). In this case, the SDK will automatically stop sending setpoints and <a href="./../api_reference/classmavsdk_1_1_offboard.html#classmavsdk_1_1_offboard_1aa5e0f3c02a03f2667f82d5e162221ff5">Offboard::is_active()</a> will change from <code>true</code> to <code>false</code>.</p><p>Calls to change the setpoint do not return an error! Depending on the particular use case, offboard code may need to explicitly monitor for flight mode and change behaviour appropriately (e.g. using <a href="./../api_reference/classmavsdk_1_1_telemetry.html#classmavsdk_1_1_telemetry_1a53db5fb36bf10fbc7ac004a3be9100a4">Telemetry::subscribe_flight_mode()</a>).</p><h2 id="further-information" tabindex="-1">Further Information <a class="header-anchor" href="#further-information" aria-label="Permalink to &quot;Further Information&quot;">​</a></h2><p>Additional information/examples for the Offboard API are linked below:</p><ul><li><a href="./../examples/offboard_velocity.html">Example: Offboard Velocity</a></li><li>Integration tests: <ul><li><a href="https://github.com/mavlink/MAVSDK/blob/main/src/integration_tests/offboard_velocity.cpp" target="_blank" rel="noreferrer">offboard_velocity.cpp</a></li></ul></li></ul>`,60)]))}const g=i(n,[["render",h]]);export{c as __pageData,g as default};
