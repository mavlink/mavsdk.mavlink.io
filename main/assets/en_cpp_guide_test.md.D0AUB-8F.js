import{_ as t,c as e,al as a,o as i}from"./chunks/framework.BVh3rIuO.js";const c=JSON.parse('{"title":"Testing","description":"","frontmatter":{"github_branch":"main"},"headers":[],"relativePath":"en/cpp/guide/test.md","filePath":"en/cpp/guide/test.md"}'),n={name:"en/cpp/guide/test.md"};function l(r,s,p,o,h,u){return i(),e("div",null,s[0]||(s[0]=[a(`<h1 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h1><p>The MAVSDK C++ library has both unit and integration tests, written using the <a href="https://google.github.io/googletest/primer.html" target="_blank" rel="noreferrer">Google C++ Test Framework</a> (<code>gtest</code>). The unit tests are run every time new code is committed to the library, and must pass before the code can be merged.</p><p>This topic shows how to run the existing tests.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>For information on <em>writing</em> tests see: <a href="./../contributing/plugins.html#testing">Writing Plugins &gt; Test Code</a>.</p></div><h2 id="running-unit-tests" tabindex="-1">Running Unit Tests <a class="header-anchor" href="#running-unit-tests" aria-label="Permalink to &quot;Running Unit Tests&quot;">​</a></h2><p>To run all unit tests:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>./build/default/src/unit_tests_runner</span></span></code></pre></div><h2 id="running-integration-tests" tabindex="-1">Running Integration Tests <a class="header-anchor" href="#running-integration-tests" aria-label="Permalink to &quot;Running Integration Tests&quot;">​</a></h2><p>Tests can be run against the simulator (either manually starting PX4 SITL or letting the tests start it automatically) or against a real vehicle.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>To run SITL you will need to install the <em>Gazebo</em> simulator. This is included as part of the standard PX4 installation for <a href="https://docs.px4.io/master/en/dev_setup/dev_env_mac.html" target="_blank" rel="noreferrer">macOS</a> and <a href="https://docs.px4.io/master/en/dev_setup/dev_env_linux_ubuntu.html" target="_blank" rel="noreferrer">Linux</a>. It does not run on Windows.</p></div><h3 id="autostart-px4-sitl" tabindex="-1">Autostart PX4 SITL <a class="header-anchor" href="#autostart-px4-sitl" aria-label="Permalink to &quot;Autostart PX4 SITL&quot;">​</a></h3><p>Make sure that the <a href="https://docs.px4.io/master/en/simulation/gazebo.html" target="_blank" rel="noreferrer">PX4 Gazebo simulation</a> is built and works:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cd path/to/Firmware/</span></span>
<span class="line"><span>make px4_sitl gazebo</span></span></code></pre></div><p>Then press <strong>Ctrl+C</strong> to stop the simulation and run the integration tests:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cd path/to/MAVSDK/</span></span>
<span class="line"><span>AUTOSTART_SITL=1 ./build/debug/src/integration_tests/integration_tests_runner</span></span></code></pre></div><p>To run the tests without the 3D viewer (<em>gzclient</em>), use:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AUTOSTART_SITL=1 HEADLESS=1 ./build/debug/src/integration_tests/integration_tests_runner</span></span></code></pre></div><h3 id="run-px4-sitl-manually" tabindex="-1">Run PX4 SITL Manually <a class="header-anchor" href="#run-px4-sitl-manually" aria-label="Permalink to &quot;Run PX4 SITL Manually&quot;">​</a></h3><p>Build and run the PX4 simulation manually:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cd path/to/Firmware/</span></span>
<span class="line"><span>make px4_sitl gazebo</span></span></code></pre></div><p>Then run the tests as shown:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cd path/to/MAVSDK/</span></span>
<span class="line"><span>./build/debug/src/integration_tests/integration_tests_runner</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The tests are designed to run in simulation, and may not be safe if run on a real vehicle.</p></div><h3 id="gtest-tricks" tabindex="-1">Gtest Tricks <a class="header-anchor" href="#gtest-tricks" aria-label="Permalink to &quot;Gtest Tricks&quot;">​</a></h3><p>To list all integration tests:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>./build/default/src/integration_tests/integration_tests_runner --gtest_list_tests</span></span></code></pre></div><p>To run a single integration test:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>./build/default/src/integration_tests/integration_tests_runner --gtest_filter=&quot;SitlTest.TelemetryAsync&quot;</span></span></code></pre></div><p>To run all telemetry tests:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>./build/default/src/integration_tests/integration_tests_runner --gtest_filter=&quot;SitlTest.Telemetry*&quot;</span></span></code></pre></div><h2 id="fuzz-testing" tabindex="-1">Fuzz Testing <a class="header-anchor" href="#fuzz-testing" aria-label="Permalink to &quot;Fuzz Testing&quot;">​</a></h2><p>MAVSDK includes a MAVLink fuzzer using libfuzzer to find bugs through randomized input testing. Fuzzing requires the Clang compiler.</p><h3 id="building-the-fuzzer" tabindex="-1">Building the Fuzzer <a class="header-anchor" href="#building-the-fuzzer" aria-label="Permalink to &quot;Building the Fuzzer&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Bbuild-fuzz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -GNinja</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -DBUILD_FUZZ_TESTS=ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -DCMAKE_C_COMPILER=clang</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -DCMAKE_CXX_COMPILER=clang++</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --build</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build-fuzz</span></span></code></pre></div><h3 id="running-the-fuzzer" tabindex="-1">Running the Fuzzer <a class="header-anchor" href="#running-the-fuzzer" aria-label="Permalink to &quot;Running the Fuzzer&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run for 60 seconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./build-fuzz/src/fuzz_tests/mavlink_fuzzer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fuzz_corpus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -max_total_time=60</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run with more options</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./build-fuzz/src/fuzz_tests/mavlink_fuzzer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -help</span></span></code></pre></div><p>The <code>fuzz_corpus/</code> directory stores test cases that the fuzzer discovers. This corpus grows over time and improves fuzzing effectiveness.</p>`,37)]))}const g=t(n,[["render",l]]);export{c as __pageData,g as default};
